
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Dokumentation für das Projektstudium" name="description"/>
<meta content="Boris Caspary, Emma Calewaert, Jonathan Neidel, Joscha Seelig, Leon Enzenberger, Ryan Torzynski, Simon Breiter, Stefan Sadewasser" name="author"/>
<link href="https://htw-projekt-p2p-volltextsuche.github.io/docs/p2p-dht/design/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.3.2" name="generator"/>
<title>Design - HTW P2P Volltextsuche</title>
<link href="../../assets/stylesheets/main.24c991ad.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#design">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="HTW P2P Volltextsuche" class="md-header__button md-logo" data-md-component="logo" href="../.." title="HTW P2P Volltextsuche">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            HTW P2P Volltextsuche
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Design
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/htw-projekt-p2p-volltextsuche/docs/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    htw-projekt-p2p-volltextsuche/docs
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../home/">
        Home
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../design_decisions/about/">
        Design decisions
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../crawler/about/">
        Text Processing
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../about/">
        Fulltext-search
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../user_interface/problemstellung/">
        User Interface
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../ops/about/">
        OPS
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../outlook/about/">
        Outlook
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="HTW P2P Volltextsuche" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="HTW P2P Volltextsuche">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    HTW P2P Volltextsuche
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/htw-projekt-p2p-volltextsuche/docs/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    htw-projekt-p2p-volltextsuche/docs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Home" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Home
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../home/">
        Credits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../home/basic_concepts/">
        Basic concepts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../home/subject/">
        Subject
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../home/work_division/">
        Work division
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          Design decisions
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Design decisions" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Design decisions
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../design_decisions/about/">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../design_decisions/architecture_diagram/">
        Architecture Diagram
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../design_decisions/speech_handling_diagrams/">
        Speech Handling Diagrams
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../design_decisions/partition_by_keyword/">
        Partition by Keyword
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Text Processing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Text Processing" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Text Processing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1">
          Crawler
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Crawler" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
          Crawler
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../crawler/about/">
        Über
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../crawler/installation/">
        Installation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2">
          Textextraction 19
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Textextraction 19" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          Textextraction 19
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-19/about/">
        Über
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-19/titel_der_reden/">
        Titel der Reden
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-19/nutzung/">
        Nutzung
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-19/anforderungen/">
        Anforderungen
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-19/format/">
        Format der zurückgegebenen JSON-Datei
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3">
          Textextraction 18
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Textextraction 18" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          Textextraction 18
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-18/textextraction-18/">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-18/problems/">
        Problems
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-18/build_jar_file/">
        Build Jar File
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../textextraction-18/execute/">
        Execute
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Fulltext-search
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Fulltext-search" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Fulltext-search
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1">
          P2P-DHT
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="P2P-DHT" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
          P2P-DHT
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../about/">
        About
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Design
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Design
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#framework-choice-and-data-distribution-design">
    Framework Choice and Data Distribution Design
  </a>
<nav aria-label="Framework Choice and Data Distribution Design" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#original-plan">
    Original Plan
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#choosing-a-p2p-library">
    Choosing a p2p library
  </a>
<nav aria-label="Choosing a p2p library" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#libp2ps-constraints">
    libp2p's Constraints
  </a>
<nav aria-label="libp2p's Constraints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#possible-changes-to-the-design-to-address-this">
    Possible changes to the design to address this
  </a>
<nav aria-label="Possible changes to the design to address this" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-local-remote">
    1. local &amp; remote
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-remote-only">
    2. remote only
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-localremote">
    3. local/remote
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#our-choice">
    Our choice
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-specification">
    API Specification
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-examples">
    API Examples
  </a>
<nav aria-label="API Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-to-run-the-examples">
    Setup to run the examples
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#put-appendkey">
    PUT /append/:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#put-mergekey">
    PUT /merge/:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get-key">
    GET /:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#post-batch-get">
    POST /batch-get
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../run/">
        Run
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../configure/">
        Configure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../scripts/">
        Scripts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2">
          Fulltext-search
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Fulltext-search" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
          Fulltext-search
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../fulltext-search/about/">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fulltext-search/get_started/">
        Get Started
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fulltext-search/retrieve_search_results/">
        Retrieve search results
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
          User Interface
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="User Interface" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          User Interface
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user_interface/problemstellung/">
        Problemstellung
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user_interface/l%C3%B6sungsansatz/">
        Lösungsansatz
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user_interface/probleme/">
        Probleme
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user_interface/schlussbetrachtung/">
        Schlussbetrachtung
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user_interface/verwendung_der_software/">
        Verwendung der Software
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          OPS
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="OPS" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          OPS
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ops/about/">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ops/setup/">
        Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ops/challenges/">
        Challenges
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          Outlook
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Outlook" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Outlook
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../outlook/about/">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../outlook/future_optimizations/">
        Optimizations
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#framework-choice-and-data-distribution-design">
    Framework Choice and Data Distribution Design
  </a>
<nav aria-label="Framework Choice and Data Distribution Design" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#original-plan">
    Original Plan
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#choosing-a-p2p-library">
    Choosing a p2p library
  </a>
<nav aria-label="Choosing a p2p library" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#libp2ps-constraints">
    libp2p's Constraints
  </a>
<nav aria-label="libp2p's Constraints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#possible-changes-to-the-design-to-address-this">
    Possible changes to the design to address this
  </a>
<nav aria-label="Possible changes to the design to address this" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-local-remote">
    1. local &amp; remote
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-remote-only">
    2. remote only
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-localremote">
    3. local/remote
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#our-choice">
    Our choice
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-specification">
    API Specification
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-examples">
    API Examples
  </a>
<nav aria-label="API Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-to-run-the-examples">
    Setup to run the examples
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#put-appendkey">
    PUT /append/:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#put-mergekey">
    PUT /merge/:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get-key">
    GET /:key
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#post-batch-get">
    POST /batch-get
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/htw-projekt-p2p-volltextsuche/docs/edit/master/docs/p2p-dht/design.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="design">Design</h1>
<h2 id="framework-choice-and-data-distribution-design">Framework Choice and Data Distribution Design</h2>
<blockquote>
<p>How the inverted index should be distributed with the DHT</p>
</blockquote>
<h3 id="original-plan">Original Plan</h3>
<p><strong>Indexing</strong></p>
<p>Initally the plan we developed was to have the crawler send the extracted and
structured documents to it's local full-text-search, which would break it up and
assemble groups of keywords. Those groups of keywords are to be split up accross
the p2p network, turned into an inverted index and persisted with the dht.</p>
<p><strong>Retrieval</strong></p>
<p>The posting lists of the inverted index are available to the full-text-search
component through an http server, which answers the UI's queries for searches.</p>
<h3 id="choosing-a-p2p-library">Choosing a p2p library</h3>
<p>I had decided that <a href="https://libp2p.io">libp2p</a> would be the p2p framework to be
used, as it fullfilled all the other demands of the project:</p>
<ul>
<li>net and routing (different configurable ways to run/setup the network)</li>
<li>content routing (put/get using key-value pairs)</li>
<li>static connection addresses</li>
<li>well maintained and documented</li>
<li>efficient transports</li>
<li>well tested with checks and corrections throughout to maintain consistent
  state and functionality</li>
</ul>
<p>It was preferable to:</p>
<ol>
<li>using a smaller (and/or outdated) library that didn't cover the demands above</li>
<li>building the system from the ground up, for which the timeframe would be
   tight and it probably would not reach libp2p's level of consistency</li>
</ol>
<h4 id="libp2ps-constraints">libp2p's Constraints</h4>
<p>One constraint that comes along with using libp2p is that the
<a href="https://github.com/libp2p/js-libp2p-kad-dht/blob/2137e2a89f9d1a32f870b3ccce40d5cbb3d1af16/src/content-fetching/index.js#L103">put</a>
separates local and remote insertion. Looking at the implementation of put it
always inserts locally and then remotely into the network.
This is not to our specification as we did not want to make a distinction
between local and remote but just wanted to insert on the peer(s) closest to the
hashed key of the value to be inserted.</p>
<h5 id="possible-changes-to-the-design-to-address-this">Possible changes to the design to address this</h5>
<h6 id="1-local-remote">1. local &amp; remote</h6>
<p>Keep current design and use the given implementation to insert once locally and
n-times remotely.</p>
<p><strong>Pro:</strong>
- scalable: the processing of keywords -&gt; posting lists happens distributed
  accross the network</p>
<p><strong>Contra:</strong>
- suboptimal inverted index distribution: the algorithm used in the
  full-text-search component - to divvy up the keywords to different peers for
  computation - would be responsible for distribution the local part of the data
  accross the network
- no separation of concerns: again the algorithm just mentioned handles
  functionality that should be part of the p2p net</p>
<h6 id="2-remote-only">2. remote only</h6>
<p>Designate a peer to become the central crawler and inserter instance and only
insert remotely.</p>
<p><strong>Pro:</strong>
- optimal inverted index distribution: by inserted in the closest peer, to the
  specification of kademlia this would be the most optimal distribution of the
  data accross the network
- simple implementation: least effort to implement (no balancing algorithm in
  full-text-search, trivial adjustment in the framework)</p>
<p><strong>Contra:</strong>
- not scalable: to have all the computation of creating the index done on a
  single peer has a natural limit and is not an efficient use of the networks
  resources
- resource imbalance: increased data load on the rest of the peers, storage
  resources unused (hd and cpu (see previous point))
- single point of failure: not critial though, as the indexing only happens
  upfront and very occasionally throughout service</p>
<h6 id="3-localremote">3. local/remote</h6>
<p>Fork the framework and adjust it to do local and remote put/get through the same
routines. This would be the optimal solution and satifies the original design.</p>
<p><strong>Pro:</strong>
- optimal inverted index distribution: same as with 2.
- optimal resource usage: storage and cpu load are distributed equally
- scalable: same as with 1.</p>
<p><strong>Contra:</strong>
- stability/introduction of inconsistencies: requires heavy modification of the
  framework, which will possibly circumvent checks and corrections within it and
  produce a less stable framework as a result
- a lot of work: most effort by far, I tried implementing this and hit one
  hurdle after another, the underlying system (kademlia and k-buckets below
  libp2p) definitely allow for this change, but you are just fighting
  against libp2p at every point</p>
<h5 id="our-choice">Our choice</h5>
<p>We decided upon moving forward with "remote only" (2.) as the downsides are
very much tolerable along with having the best of both words on the pro side.</p>
<h2 id="api-specification">API Specification</h2>
<p><a href="https://github.com/htw-projekt-p2p-volltextsuche/p2p-dht/blob/main/docs/openapi.yaml">As defined here</a>.</p>
<pre><code class="language-yaml">openapi: 3.1.0
info:
  title: P2P framework
  version: 0.2
paths:
  /:key:
    get:
      summary: Get an entry from hash table
      description: data is an array
      parameters:
      - name: key
        in: path
      responses:
        "200":
          description: OK
          content:
            schema:
              format:
                error: "boolean"
                key: "string"
                value: "any[]"
              example:
                error: false
                key: "Grundgesetz"
                value: [ "postingList1", "postingList2" ]
        "400":
          description: User error
          content:
            schema:
              format:
                error: "boolean"
                errorMsg: "string"
              example:
                error: true
                errorMsg: "No key given"
  /append/:key:
    put:
      summary: Append to an entry in the hash table
      description: Entities are an array, to which you can add a single value through this route
      parameters:
      - name: key
        in: path
      - name: data
        in: body
        schema:
          format:
            data: "any"
          example:
            data: { id: 123 }
      responses:
        "200":
          description: OK
          content:
            schema:
              format:
                error: "boolean"
                key: "string"
              example:
                error: false
                key: "Grundgesetz"
        "400":
          description: User error
          content:
            schema:
              format:
                error: "boolean"
                errorMsg: "string"
              example:
                error: true
                errorMsg: "missing data"
  /merge/:key:
    put:
      summary: Merge with the array in the hash table
      description: Entities are an array, to which you can add a mutiple values through this route by wrapping them in an array
      parameters:
      - name: key
        in: path
      - name: data
        in: body
        schema:
          format:
            data: "any[]"
          example:
            data: [ { id: 123 }, { id: 124 } ]
      responses:
        "200":
          description: OK
          content:
            schema:
              format:
                error: "boolean"
                key: "string"
              example:
                error: false
                key: "Grundgesetz"
        "400":
          description: User error
          content:
            schema:
              format:
                error: "boolean"
                errorMsg: "string"
              example:
                error: true
                errorMsg: "missing data"
  /batch-get:
    post:
      summary: Get multiple entries of the hash table
      description:
        parameters:
          - name: keys
            in: body
            schema:
              format:
                data: "string[]"
        responses:
          "200":
            description: OK
            content:
              schema:
                format:
                  error: "boolean"
                  keys: "string[]"
                  values: "object"
                example:
                  error: false
                  keys: [ "Grundgesetz", "Merkel" ]
                  values: {
                    "Grungesetz": {
                      "error": false,
                      "value": [ "postingList1", "postingList2" ]
                    },
                    "Merkel": {
                      "error": true,
                      "errorMsg": "Not found"
                    }
          "400":
            description: User error
            content:
              schema:
                format:
                  error: "boolean"
                  errorMsg: "string"
                example:
                  error: true
                  errorMsg: "missing keys"
</code></pre>
<p>Also there is a key mangaged by the system named <code>_keyset_size</code>, which tracks
the number of keysets in the dht.</p>
<h2 id="api-examples">API Examples</h2>
<h3 id="setup-to-run-the-examples">Setup to run the examples</h3>
<pre><code class="language-sh">./spawnnode 1 &amp;
#=&gt; Server running on http://localhost:8091

./spawnnode 2 &amp;
#=&gt; Server running on http://localhost:8092

./spawnnode 3 &amp;
#=&gt; Server running on http://localhost:8093
</code></pre>
<h3 id="put-appendkey">PUT <code>/append/:key</code></h3>
<pre><code class="language-sh">curl -Ss -X PUT "http://localhost:8093/append/linux" -d '{"data":"arch"}' -H "Content-Type: application/json"
curl -Ss -X PUT "http://localhost:8093/append/linux" -d '{"data":"debian"}' -H "Content-Type: application/json"
</code></pre>
<pre><code>{
  "error": false,
  "key": "linux"
}
</code></pre>
<h3 id="put-mergekey">PUT <code>/merge/:key</code></h3>
<pre><code class="language-sh">curl -Ss -X PUT "http://localhost:8093/merge/linux" -d '{"data":["ubuntu","manjaro"]}' -H "Content-Type: application/json"
</code></pre>
<pre><code>{
  "error": false,
  "key": "linux"
}
</code></pre>
<h3 id="get-key">GET <code>/:key</code></h3>
<pre><code class="language-sh">curl -Ss "http://localhost:8091/linux"
</code></pre>
<pre><code>{
  "error": false,
  "key": "linux",
  "value": [
    "arch",
    "debian",
    "ubuntu",
    "manjaro"
  ]
}
</code></pre>
<h3 id="post-batch-get">POST <code>/batch-get</code></h3>
<pre><code class="language-sh">curl -Ss -X POST "http://localhost:8092/batch-get" -d '{"keys":["linux","windows"]}' -H "Content-Type: application/json"
</code></pre>
<pre><code>{
  "error": false,
  "keys": [
    "linux",
    "windows"
  ],
  "values": {
    "linux": {
      "error": false,
      "value": [
        "arch",
        "debian",
        "ubuntu",
        "manjaro"
      ]
    },
    "windows": {
      "error": true,
      "errorMsg": "Not found"
    }
  }
}
</code></pre>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: About" class="md-footer__link md-footer__link--prev" href="../about/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              About
            </div>
</div>
</a>
<a aria-label="Next: Run" class="md-footer__link md-footer__link--next" href="../run/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Run
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
            Material for MkDocs
          </a>
 ... <a class="link--pdf-download" download href="../../../docs.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
<script src="../../assets/javascripts/bundle.bc35569b.min.js"></script>
</body>
</html>